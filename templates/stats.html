<!-- templates/stats.html -->
{% extends 'base.html' %}
{% block content %}
<h4>Statistics</h4>
<div class="row">
  <div class="col-md-8">
    <canvas id="monthlyChart" height="120"></canvas>
  </div>
  <div class="col-md-4">
    <canvas id="categoryChart" height="180"></canvas>
  </div>
</div>

<script>
async function drawMonthly() {
  const res = await fetch('/api/summary');
  const data = await res.json();
  const labels = data.map(d => d.month);
  const totals = data.map(d => d.total);
  new Chart(document.getElementById('monthlyChart'), {
    type: 'bar',
    data: { labels, datasets: [{ label: 'Total', data: totals }] },
    options: { responsive: true }
  });
}
async function drawCategory() {
  const res = await fetch('/api/category-summary');
  const data = await res.json();
  const labels = data.map(d => d.category);
  const totals = data.map(d => d.total);
  new Chart(document.getElementById('categoryChart'), {
    type: 'pie',
    data: { labels, datasets: [{ label: 'By Category', data: totals }] },
    options: { responsive: true }
  });
}
drawMonthly();
drawCategory();
</script>
{% endblock %}
